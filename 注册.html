<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="css/zhuce.css" />
		<script src="js/jquery-1.8.3.min.js"></script>
	</head>
	<body>
		<div id="box">
			<div class="nav"></div>
			<!--内容部分开始-->
			<div class="container">
				<div class="containerLeft">
					<img src="img/zhuce.jpg" />
					<a href="###"><input type="button" value="会员注册" class="btn"/></a>
				</div>
				<div class="containerRight">
					<!--登录框-->
					<form class="dl">
						<p>用户名:<input type="text" class="name1"/></p>
						<div><span class="nametxt1"></span></div>
						<p>密码:<input type="password" class="pwd1"/></p>
						<div><span class="pwdtxt1"></span></div>
						<input type="button" value="登录" class="btn1">
						<!--<input type="button" value="注册" class="btn2">-->
					</form>
					<!--注册框-->
					<form class="zc">
						<p>用户名:<input type="text" class="name2"/></p>
						<div><span class="nametxt2"></span></div>
						<p>密码:<input type="password" class="pwd2"></p>
						<div><span class="pwdtxt2"></span></div>
						<p>确认密码:<input type="password" class="nextpwd2"></p>
						<div><span class="nextpwdtxt2"></span></div>
						<p>验证码:<input type="text" class="yzm" />
						<input type="text" class="yzm2" />
						<input type="button" class="change" value="换一批"/>			
						</p>
						<div><p><span class="yzmtxt"></span></p></div>
						<input type="button" class="zhuce" value="注册"/>
					</form>
				</div>
			</div>
			<!--尾部-->
			<div class="footer"></div>
			<div class="up"><a href="#">顶部TOP</a></div>
		</div>
	</body>
	<script>
		$(function(){
			$(".nav").load("nav.html");
			$(".nav .center li:eq(0)").removeClass("active");
			$(".footer").load("footer.html");
//			console.log($(".pwdtxt1").text());
			//选择登录还是注册
			$(".btn").click(function(){
				($(".btn").val()=="会员登录")?$(".btn").val("会员注册"):$(".btn").val("会员登录");
				if($(".btn").val()=="会员登录"){
					$(".dl").css({
						"display":"none"
					});
					$(".zc").css({
						"display":"block"
					})
				}else if($(".btn").val()=="会员注册"){
					$(".dl").css({
						"display":"block"
					});
					$(".zc").css({
						"display":"none"
					})
				}
			});
			
			//getJSON后台获取
			var flag=0;
			$.getJSON("user.json",function(user){
				console.log(user);
				//登录框设置(模拟后台)
				$(".btn1").click(function(){
					$(".nametxt1").text("");
					$(".pwdtxt1").text("");
					if($(".name1").val()==""){
						$(".nametxt1").text("#用户名不能为空")
					}
					for(let i=0;i<user.length;i++){
						if($(".name1").val()==user[i].name){
							flag++;
							var x=i;
							if($(".pwd1").val()==user[x].pwd){
								alert("登陆成功");
								$(".name1").val("");
								$(".pwd1").val("");
							}else{
								$(".pwdtxt1").text("#密码错误");
							}
							break;
						}
					}
					if(flag==0){
						$(".nametxt1").text("#用户名不存在")
					}
				})
				//注册框设置
				//用户名设置
				var fg=0;
				$(".name2").blur(function(){
					$(".nametxt2").text("");
//					$(".pwdtxt2").text("");
//					$(".nextpwdtxt2").text("");
//					console.log($(".name2").val());
					for(let i=0;i<user.length;i++){
						if($(".name2").val()==user[i].name){
							$(".nametxt2").text("#用户名已存在")
							fg++;
						}else if($(".name2").val()==""){
							$(".nametxt2").text("#用户名不能为空")
							fg++;
						}else{
							fg=0;
						}
					}
				})
				//密码设置
				$(".pwd2").blur(function(){
					$(".pwdtxt2").text("");
					var mypwd=$(".pwd2").val();
					var reg=/^[0-9a-zA-Z][0-9a-zA-Z_]{5,11}$/;//
					if(reg.test(mypwd)){//
						$(".pwdtxt2").text("");
						//密码确认设置
							$(".nextpwd2").blur(function(){
								$(".nextpwdtxt2").text("");
								if($(".nextpwd2").val()==""){
									$(".nextpwdtxt2").text("确认密码不能为空");
									fg++;
								}else if($(".nextpwd2").val()==$(".pwd2").val()&&$(".nextpwd2").val()!=""){
									$(".nextpwdtxt2").text("密码设置成功");
									fg=0;
								}else{
									$(".nextpwdtxt2").text("#请保持与输入密码一致");
									fg++;
								}
							})
					}else if($(".pwd2").val()==""){
						$(".pwdtxt2").text("#密码不能为空");
						fg++;
					}else{
						$(".pwdtxt2").text("#密码由6-12位字母数字下划线组成");
						fg++;
					}
				})
				
				//验证码设置
				//验证码获取(4位)
				var n=parseInt(Math.random()*10000);
				//判断验证的位数
				if(n<1000&&n>100){		//验证码为三位数时
					n=""+0+n;
				}else if(n<100&&n>10){		//验证过吗为两位数时
					n=""+0+0+n;
				}else if(n<10){
					n=""+0+0+0+n;
				}
				$(".yzm2").val(n);
				$(".change").click(function(){
					var n=parseInt(Math.random()*10000);
					//判断验证的位数
					if(n<1000&&n>100){		//验证码为三位数时
						n=""+0+n;
					}else if(n<100&&n>10){		//验证过吗为两位数时
						n=""+0+0+n;
					}else if(n<10){
						n=""+0+0+0+n;
					}
					$(".yzm2").val(n);
				})
				//验证码的输入
				$(".yzm").blur(function(){
					if($(".yzm").val()==$(".yzm2").val()){
						$(".yzmtxt").text("");
					}else{
						$(".yzmtxt").text("#验证码输入错误!")
						fg++;
					}
				})
				//注册提交
				$(".zhuce").click(function(){
					$(".name2").val("");
					$(".pwd2").val("");
					$(".nextpwd2").val("");
					$(".yzm").val("");
					$(".nametxt2").text("");
					$(".pwdtxt2").text("");
					$(".nextpwdtxt2").text("");
					$(".yzmtxt").text("");
//					location="";
					console.log(fg);
					alert("注册成功!")
				})
			})
		})
	</script>
</html>
